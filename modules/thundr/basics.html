---
layout: base
title: Basics
description: thundr framework basics
---

<div class="row">
<aside class="module_nav_container span3">
	<div class="module_nav">
		<ul class="nav nav-list" role="navigation">
			<li class="nav-header active">
				<a href="{{ site.url }}modules/thundr/basics.html">
					Basics
				</a>
			</li>

			<li>
				<a href="{{ site.url }}modules/thundr/basics.html#page-overview" data-target="#page-overview">
					Overview
				</a>
			</li>

			<li class="divider"></li>

			<li>
				<a href="{{ site.url }}modules/thundr/basics.html#basicExample" data-target="#basicExample">
					Basic Example
				</a>
			</li>


			<li>
				<a href="{{ site.url }}modules/thundr/basics.html#applicationConfiguration" data-target="#applicationConfiguration">
					Configuration
				</a>
			</li>

			<li class="divider"></li>

			<li>
				<a href="{{ site.url }}modules/thundr/basics.html#webXml" data-target="#webXml">
					web.xml
				</a>
			</li>

			<li>
				<a href="{{ site.url }}modules/thundr/basics.html#modulesProperties" data-target="#modulesProperties">
					modules.properties
				</a>
			</li>


			<li>
				<a href="{{ site.url }}modules/thundr/basics.html#injectionConfiguration" data-target="#injectionConfiguration">
					InjectionConfiguration
				</a>
			</li>

			<li>
				<a href="{{ site.url }}modules/thundr/basics.html#applicationProperties" data-target="#applicationProperties">
					application.properties
				</a>
			</li>

			<li class="nav-header ">
				<a href="{{ site.url }}modules/thundr/controllers.html">
					Controllers
				</a>
			</li>

			<li class="nav-header ">
				<a href="{{ site.url }}modules/thundr/views.html">
					Views
				</a>
			</li>

			<li class="nav-header ">
				<a href="{{ site.url }}modules/thundr/actions.html">
					Actions
				</a>
			</li>

			<li class="nav-header ">
				<a href="{{ site.url }}modules/thundr/injection-context.html">
					Dependency injection
				</a>
			</li>

			<li class="nav-header ">
				<a href="{{ site.url }}modules/thundr/email.html">
					Email
				</a>
			</li>
		</ul>
	</div>
</aside>

<article id="basics" class="span9">
	<div class="page-header">
		<h1>thundr
			<small>basics</small>
		</h1>
	</div>

	<section id="page-overview" class="overview">
		<h2>Overview</h2>

		<p>
			thundr, like most other web frameworks, uses the <em>Model-View-Controller</em>, or 
			<a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MVC</a>, pattern for
			separation of concerns between data processing and view presentation.
		</p>

		<p>
			In this pattern, the model and the view and the relationship between them is mediated by a controller.
		</p>

		<p>
			In thundr, this control is enacted by the method invoked inside your controller class. 
			<a href="{{ site.url }}modules/thundr/controllers.html">more</a><br/>
			The view is represented by a <code>View</code> object, which is the return type of the controller method. 
			<a href="{{ site.url }}modules/thundr/views.html">more</a><br>
			The model is provided to the view by the controller method, but the requirements of this depend on the type 
			of view.
		</p>
	</section>

	<section id="basicExample">
		<h4>Basic Example</h4>

		<p>Routes file - routes.json <a href="{{ site.url }}modules/thundr/actions.html">more</a></p>

{% highlight json %}
{
    "/"        : "com.threewks.web.Controller.home"
}
{% endhighlight %}

		<p>Controller - Controller.java <a href="{{ site.url }}modules/thundr/controllers.html">more</a></p>

{% highlight java %}
package com.threewks.web;

import java.util.HashMap;
import java.util.Map;
import com.threewks.thundr.view.jsp.JspView;

public class Controller {
    public JspView home() {
        Map<String, Object> model = new HashMap<String, Object>();
        model.put("message", "Hello World!");
        return new JspView("home.jsp", model);
    }
}
{% endhighlight %}

		<p>Jsp - /WEB-INF/jsp/home.jsp <a href="{{ site.url }}modules/thundr/views.html#jspView">more</a></p>

{% highlight jsp %}
<%@ page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" lang="en-us"/>
    </head>
    <body>
        ${message}
    </body>
</html>
{% endhighlight %}

		<p>With these three files, if you were to visit the url <code>http://localhost:8080/</code> you would be served
			a page with the content &#39;Hello World!&#39;.</p>

		<p>We can see the basics of thundr and the three elements of the MVC interacting here:</p>
		<ul>
			<li>an incoming request is mapped to a controller using a <a
					href="{{ site.url }}modules/thundr/actions.html#routes">route</a></li>
			<li>Our <a href="{{ site.url }}modules/thundr/controllers.html">controller</a> method populates the <strong>model</strong>
				map with our message,
			</li>
			<li>which is then provided to our <a href="{{ site.url }}modules/thundr/views.html">view</a>, a JspView.</li>
			<li>thundr takes care of the rest, serving up our jsp as html, substituting the el variable \${message} with
				the text &#39;Hello World!&#39;.
			</li>
		</ul>

	</section>


	<section id="applicationConfiguration">
		<h4>Application Configuration</h4>

		<p>Beyond the basics of controller invocation and returning a view, there are several elements of configuration
			required for a thundr based application.</p>
		<ul>
			<li><a href="#webXml">web.xml</a> - configuring the thundr servlet</li>
			<li><a href="#modulesProperties">modules.properties</a> - defining the thundr modules in use</li>
			<li><a href="#injectionConfiguration">InjectionConfiguation</a> - your dependency injection configuration</li>
			<li><a href="#applicationProperties">application properties</a> - your environmental properties</li>
		</ul>
	</section>

	<section id="webXml">
		<h4><code>webXml</code></h4>

		<p>The minimum web.xml required for a thundr app is to include the thundr servlet.</p>

{% highlight xml %}
<?xml version="1.0" encoding="UTF-8"?>
<web-app
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    version="2.5">
    <servlet>
        <servlet-name>servlet</servlet-name>
        <servlet-class>com.threewks.thundr.ThundrServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>servlet</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
</web-app>
{% endhighlight %}

		<p>Beyond this, you can use any servlets, servlet filters or other web.xml features you want. Remember that
			thundr is capable of invoking a servlet as a controller if you so wish. </p>
	</section>

	<section id="modulesProperties">
		<h4><code>modules.properties</code></h4>

		<p>thundr is extensible, it allows extra features and components to be added to applications. These components
			are called <strong>modules</strong>.</p>

		<p>Modules are configured by adding them to resource <em>modules.properties</em>.</p>

		<p>This file is a standard java properties file, where only the key values are of interest.<br>Each entry causes
			a module to be loaded. The minimum modules file only needs to contain the package for the module which is
			the application.</p>

		<p>for the application defined in com.mycompany.myapp - modules.properties</p>

{% highlight java %}
com.mycompany.myapp=
{% endhighlight %}
		
		<blockquote>
			The order of modules in this file is significant, you should always put your application module at the top.
		</blockquote>
	</section>


	<section id="injectionConfiguration">
		<h4><code>InjectionConfiguration</code></h4>

		<p>A module is defined as a group of code and an <code>InjectionConfiguration</code> file.</p>

		<p>You application uses an InjectionConfiguration to make available all the instances and classes you wish to
			inject into your controllers and each-other</p>

		<p>Your injection configuration needs to implement
			<code>com.threewks.thundr.injection.InjectionConfiguration</code>. It also has to have a specific name,
			which is <strong>X</strong>InjectionConfiguration where <strong>X</strong> is the name of the package it
			resides in. </p>

		<p>For example, if your injection configuration is in the package <code>com.mycompany.myapp</code>, your<br>configuration
			must be the java class <code>com.mycompany.myapp.MyappInjectionConfiguration</code>. In this case, your <em>module</em>
			will be com.mycompany.myapp.</p>

		<p>com.mycompany.myapp.MyappInjectionConfiguration</p>

{% highlight java %}	
package com.mycompany.myapp;

import com.threewks.thundr.injection.BaseInjectionConfiguration;
import com.threewks.thundr.injection.InjectionConfiguration;
import com.threewks.thundr.injection.UpdatableInjectionContext;
import com.threewks.thundr.profiler.BasicProfiler;
import com.threewks.thundr.profiler.Profiler;

public class MyappInjectionConfiguration implements InjectionConfiguration {

    @Override
    public void configure(UpdatableInjectionContext injectionContext) {
        injectionContext.inject(MyServiceImpl.class).as(MyServiceInterface.class);
        injectionContext.inject(MyRepositoryImpl.class).as(MyRepositoryInterface.class);
    }
}
{% endhighlight %}

		<blockquote>
			The naming rules for an InjectionConfiguration are case sensitive! My<strong>a</strong>ppInjectionConfiguration
				is not the same as My<strong>A</strong>ppInjectionConfiguration.
		</blockquote>

		<p>Rather than implement <code>InjectionConfiguration</code>, you can also extend <code>BaseInjectionConfiguration</code>
			for convenience.</p>
	</section>

	<section id="applicationProperties">
		<h4><code>application.properties</code></h4>

		<p>thundr automatically loads properties from the <code>application.properties</code> file and puts them as
			named strings into the InjectionContext. This makes them available both in your InjectionConfiguration and
			also as constructor arguments to injected dependencies.</p>

		<p>This file is suitable for specifying configuration values that change per environment. That is, while all the
			other configuration is generally environmentally agnostic, the application properties will generally not
			be. </p>

		<p>This allows your built war file to be portable through environments without requiring rebuilding.</p>

{% highlight java %}
threadCount=20
threadCount%dev=2
serverUrl=localhost:8080
serverUrl%production=www.production.com
{% endhighlight %}

		<p>In the above example, all environments will have the properties <em>threadCount</em> and <em>serverUrl</em>
			injected into them, but the serverUrl for the environment named &#39;production&#39; will be different.</p>

		<blockquote>
			The environment named &#39;dev&#39; is special, in that it specifically applies to local development,
			rather than a target deployment environment.
		</blockquote>
	</section>
</article>
</div>
		